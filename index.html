<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íˆ¬ì ìì‚° í˜„í™© (ì‹¤ì‹œê°„ Naver API)</title>
    <style>
        /* ê¸°ë³¸ì ì¸ í‘œ ìŠ¤íƒ€ì¼ (ì´ì „ê³¼ ë™ì¼) */
        table {
            width: 100%;
            border-collapse: collapse;
            font-family: Arial, sans-serif;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: right;
            white-space: nowrap;
        }
        th {
            background-color: #f2f2f2;
            text-align: center;
            font-size: 0.85em;
        }
        .current-price {
            font-weight: bold;
            color: #1a73e8; /* í˜„ì¬ê°€ë¥¼ ê°•ì¡° */
        }
        .text-left {
            text-align: left;
        }
        .total-row {
            font-weight: bold;
            background-color: #e0f2f1; /* ì´í•© í–‰ ë°°ê²½ìƒ‰ */
        }
    </style>
</head>
<body>

    <h1>íˆ¬ì ìì‚° í˜„í™©</h1>
    <p>í˜„ì¬ê°€ëŠ” Naver Finance APIë¥¼ í†µí•´ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤. (ì—…ë°ì´íŠ¸ ì‹œê°„: <span id="lastUpdated">N/A</span>)</p>

    <table id="assetTable">
        <thead>
            <tr>
                <th rowspan="2">ìƒí’ˆ</th>
                <th rowspan="2">í‰ê°€ê¸ˆì•¡</th>
                <th rowspan="2">í˜„ì¬ê°€</th>
                <th colspan="7">K (ê°œì¸ì—°ê¸ˆ)</th>
                <th colspan="4">H (IRP/ISA/ì¼ë°˜)</th>
            </tr>
            <tr>
                <th>IRP(í‡´ì§ê¸ˆ/ê°œì¸)</th>
                <th>IRP(ê°œì¸)</th>
                <th>IRP(ê°œì¸+í‡´ì§ê¸ˆ)</th>
                <th>êµ¬ì—°ê¸ˆì €ì¶•</th>
                <th>ì—°ê¸ˆì €ì¶•(ì„¸ê¸ˆ)</th>
                <th>ì—°ê¸ˆì €ì¶•(ISA)</th>
                <th>ì¼ë°˜ê³„ì¢Œ</th>
                <th>KKBì €ê¸ˆ</th>
                <th>ê¸ˆìœµì›</th>
                <th>IRP(ê°œì¸)</th>
                <th>ISA</th>
                <th>ì¼ë°˜</th>
            </tr>
        </thead>
        <tbody>
            <tr data-ticker="360200"> 
                <td class="text-left">TIGER ë¯¸êµ­S&P500</td>
                <td>0</td>
                <td class="current-price" data-ticker-price>0</td> 
                <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
            </tr>
            <tr data-ticker="352720">
                <td class="text-left">KODEX ë¯¸êµ­S&P500</td>
                <td>0</td>
                <td class="current-price" data-ticker-price>0</td>
                <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
            </tr>
            <tr data-ticker="458510">
                <td class="text-left">RISE ë¯¸êµ­ë‚˜ìŠ¤ë‹¥100</td>
                <td>0</td>
                <td class="current-price" data-ticker-price>0</td>
                <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
            </tr>
            <tr data-ticker="474020">
                <td class="text-left">1Q ë¯¸êµ­S&P500ë¯¸êµ­ì±„í˜¼í•©50ì•¡í‹°ë¸Œ</td>
                <td>0</td>
                <td class="current-price" data-ticker-price>0</td>
                <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
            </tr>
            <tr data-ticker="474010">
                <td class="text-left">1Q ë¯¸êµ­ë‚˜ìŠ¤ë‹¥100ë¯¸êµ­ì±„í˜¼í•©50ì•¡í‹°ë¸Œ</td>
                <td>0</td>
                <td class="current-price" data-ticker-price>0</td>
                <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
            </tr>
            <tr data-ticker="453860">
                <td class="text-left">ACE ë¯¸êµ­30ë…„êµ­ì±„ì•¡í‹°ë¸Œ(H)</td>
                <td>0</td>
                <td class="current-price" data-ticker-price>0</td>
                <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
            </tr>
            <tr data-ticker="365730">
                <td class="text-left">ì‚¼ì„±ë¯¸êµ­S&P500ì¸ë±ìŠ¤H</td>
                <td>0</td>
                <td class="current-price" data-ticker-price>0</td>
                <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
            </tr>
            <tr data-ticker="423850">
                <td class="text-left">ACE KRXê¸ˆí˜„ë¬¼</td>
                <td>0</td>
                <td class="current-price" data-ticker-price>0</td>
                <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
            </tr>
            <tr data-ticker="370500">
                <td class="text-left">KODEX 200TR</td>
                <td>0</td>
                <td class="current-price" data-ticker-price>0</td>
                <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
            </tr>
            <tr data-ticker="427500">
                <td class="text-left">KODEX 200íƒ€ê²Ÿìœ„í´ë¦¬ì»¤ë²„ë“œì½œ</td>
                <td>0</td>
                <td class="current-price" data-ticker-price>0</td>
                <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
            </tr>
            <tr data-ticker="175860">
                <td class="text-left">KRX ê¸ˆ1g</td>
                <td>0</td>
                <td class="current-price" data-ticker-price>0</td>
                <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
            </tr>
            <tr data-ticker="379530">
                <td class="text-left">KODEX ë¨¸ë‹ˆë§ˆì¼“ì•¡í‹°ë¸Œ</td>
                <td>0</td>
                <td class="current-price" data-ticker-price>0</td>
                <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
            </tr>
            <tr>
                <td class="text-left">Vanguard S&P 500 ETF (VOO)</td>
                <td>0</td>
                <td class="current-price">470.50 USD</td> 
                <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
            </tr>
            
            <tr>
                <td class="text-left total-row">ì˜ˆìˆ˜ê¸ˆ</td>
                <td class="total-row">1,234,567</td>
                <td class="total-row">N/A</td> 
                <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
            </tr>
            <tr>
                <td class="text-left total-row">í‰ê°€ê¸ˆì•¡</td>
                <td class="total-row">3,456,789</td>
                <td class="total-row">N/A</td>
                <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
            </tr>

        </tbody>
    </table>

    <script>
        // ğŸš¨ ë°°í¬ í›„, ì´ ì£¼ì†Œë¥¼ Vercel ë˜ëŠ” Netlifyì—ì„œ ìƒì„±ëœ API ì£¼ì†Œë¡œ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.
        // ì˜ˆ: https://your-github-repo-name.vercel.app/api/prices
        const API_ENDPOINT = 'YOUR_DEPLOYED_SERVERLESS_FUNCTION_URL/api/prices'; 

        // í‹°ì»¤ ëª©ë¡ì„ ì¶”ì¶œí•˜ëŠ” í•¨ìˆ˜
        function getTickerList() {
            const tickerElements = document.querySelectorAll('tr[data-ticker]');
            const tickers = [];
            tickerElements.forEach(row => {
                const ticker = row.getAttribute('data-ticker');
                if (ticker) {
                    tickers.push(ticker);
                }
            });
            return tickers;
        }

        // í˜„ì¬ê°€ë¥¼ ê°€ì ¸ì™€ì„œ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
        async function updateCurrentPrices() {
            const tickers = getTickerList();
            
            // ë°°í¬ URL ì„¤ì • í™•ì¸
            if (tickers.length === 0 || API_ENDPOINT.includes('YOUR_DEPLOYED_SERVERLESS_FUNCTION_URL')) {
                 console.error("API ì—”ë“œí¬ì¸íŠ¸ URLì„ ë°°í¬ëœ ì£¼ì†Œë¡œ ì„¤ì •í•´ì£¼ì„¸ìš”.");
                 return;
            }

            console.log("ì‹¤ì‹œê°„ í˜„ì¬ê°€ ì—…ë°ì´íŠ¸ ì‹œì‘. í‹°ì»¤:", tickers);

            try {
                // Serverless Functionì— ì¢…ëª© ì½”ë“œë¥¼ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ ì „ì†¡
                const response = await fetch(`${API_ENDPOINT}?tickers=${tickers.join(',')}`);

                if (!response.ok) {
                    throw new Error(`HTTP ì˜¤ë¥˜: ${response.status}`);
                }

                const data = await response.json();
                
                // ë°›ì•„ì˜¨ ë°ì´í„°ë¡œ í‘œ ì—…ë°ì´íŠ¸
                for (const ticker in data) {
                    const price = data[ticker];
                    if (price) {
                        // ìˆ«ìë¥¼ í•œêµ­ í˜•ì‹(ì‰¼í‘œ í¬í•¨)ìœ¼ë¡œ ë³€í™˜
                        const formattedPrice = price.toLocaleString('ko-KR', { minimumFractionDigits: 0 }); 
                        
                        const row = document.querySelector(`tr[data-ticker="${ticker}"]`);
                        if (row) {
                            const priceCell = row.querySelector('[data-ticker-price]');
                            if (priceCell) {
                                priceCell.textContent = formattedPrice;
                                priceCell.style.color = 'green';
                            }
                        }
                    }
                }
                
                // ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ ì‹œê°„ ê¸°ë¡
                document.getElementById('lastUpdated').textContent = new Date().toLocaleTimeString('ko-KR');
                console.log("í˜„ì¬ê°€ ì—…ë°ì´íŠ¸ ì™„ë£Œ.");

            } catch (error) {
                console.error("í˜„ì¬ê°€ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:", error);
                document.getElementById('lastUpdated').textContent = 'ì—…ë°ì´íŠ¸ ì‹¤íŒ¨';
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ í˜„ì¬ê°€ ì—…ë°ì´íŠ¸ ì‹¤í–‰ ë° 30ì´ˆë§ˆë‹¤ ë°˜ë³µ (ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸)
        document.addEventListener('DOMContentLoaded', () => {
            updateCurrentPrices();
            setInterval(updateCurrentPrices, 30 * 1000); // 30ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸
        });
    </script>
</body>
</html>
